CREATE PROCEDURE extraer_imbds(in nacion varchar(25))
BEGIN

    declare v_peli int;
    declare v_actores int;
    declare v_direct in;

    -- crea una nueva relacion
    set @sql = concat('CREATE TABLE IF NOT EXIST', nacion_tabla, ' (code_imbd VARCHAR(255))');
    prepare stmt from @sql;
    execute stmt;

    declare peliAux cursor for
    SELECT ID_pelicula from Peliculas where nacionalidad = nacion;
    declare actoresAux cursor for
    SELECT ID_actor from Actores where nacionalidad = nacion;
    declare directAux cursor for
    SELECT ID_director from Directores where nacionalidad = nacion;
    
    --peliculas
    open peliAux;
    fetch peliAux into v_peli;

    WHILE @@FETCH_STATUS = 0 DO
        SET @sql = CONCAT('INSERT INTO ', nacion_tabla, ' (code_imdb) VALUES (''', v_peli, ''')');
        PREPARE stmt FROM @sql;
        EXECUTE stmt;
        
        fetch peliAux into v_peli;
    END WHILE;

    close peliAux;

    --actores
    open actoresAux;
    fetch actoresAux into v_actores;

    WHILE @@FETCH_STATUS = 0 DO
        SET @sql = CONCAT('INSERT INTO ', nacion_tabla, ' (code_imdb) VALUES (''', v_actores, ''')');
        PREPARE stmt FROM @sql;
        EXECUTE stmt;
        
        fetch actoresAux into v_actores;
    END WHILE;

    close actoresAux;

    --directores
    open directAux;
    fetch directAux into v_direct;

    WHILE @@FETCH_STATUS = 0 DO
        SET @sql = CONCAT('INSERT INTO ', nacion, ' (code_imdb) VALUES (''', v_direct, ''')');
        PREPARE stmt FROM @sql;
        EXECUTE stmt;
        
        fetch directAux into v_direct;
    END WHILE;

    close directAux;

END;

ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'in;

    
    set @sql = concat('CREATE TABLE IF NOT EXIST', nacion_tabla, ' (co' at line 6
