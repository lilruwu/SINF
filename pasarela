CREATE PROCEDURE extraer_imbds(in nacion varchar(25))
BEGIN
    declare v_peli int;
    declare v_actores int;
    declare v_direct int;
    declare fin_cursor boolean default false;
    DECLARE peliAux CURSOR FOR
    SELECT ID_pelicula from Peliculas where nacionalidad = nacion;
    declare actoresAux cursor for
    SELECT ID_actor from Actores where nacionalidad = nacion;
    declare directAux cursor for
    SELECT ID_director from Directores where nacionalidad = nacion;
    DECLARE CONTINUE HANDLER FOR NOT FOUND SET fin_cursor = TRUE;

  
   

    -- define el nombre de la tabla según la nacionalidad

    -- crea una nueva relación
    set @sql = concat('CREATE TABLE IF NOT EXISTS ', nacion, ' (nacionalidad VARCHAR(255))');
    prepare stmt from @sql;
    execute stmt;

    

  /*peliculas*/
    OPEN peliAux;
    fetch peliAux into v_peli;

    WHILE not fin_cursor DO
        SET @sql = CONCAT('INSERT INTO ', nacion, ' (code_imdb) VALUES (''', v_peli, ''')');
        PREPARE stmt FROM @sql;
        EXECUTE stmt;

        fetch peliAux into v_peli;
    END WHILE;

    close peliAux;

    /*actores*/
    open actoresAux;
    fetch actoresAux into v_actores;

    WHILE not fin_cursor DO
        SET @sql = CONCAT('INSERT INTO ', nacion, ' (code_imdb) VALUES (''', v_actores, ''')');
        PREPARE stmt FROM @sql;
        EXECUTE stmt;

        fetch actoresAux into v_actores;
    END WHILE;

    close actoresAux;

    /*directores*/
    open directAux;
    fetch directAux into v_direct;

    WHILE not fin_cursor DO
        SET @sql = CONCAT('INSERT INTO ', nacion, ' (code_imdb) VALUES (''', v_direct, ''')');
        PREPARE stmt FROM @sql;
        EXECUTE stmt;

        fetch directAux into v_direct;
    END WHILE;

    close directAux;

END;
    
    mysql> call extraer_imbds('Estados Unidos');
ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'Unidos (code_imdb) VALUES ('1')' at line 1
